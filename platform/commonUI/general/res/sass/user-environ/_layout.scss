/*****************************************************************************
 * Open MCT Web, Copyright (c) 2014-2015, United States Government
 * as represented by the Administrator of the National Aeronautics and Space
 * Administration. All rights reserved.
 *
 * Open MCT Web is licensed under the Apache License, Version 2.0 (the
 * "License"); you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 * http://www.apache.org/licenses/LICENSE-2.0.
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS, WITHOUT
 * WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied. See the
 * License for the specific language governing permissions and limitations
 * under the License.
 *
 * Open MCT Web includes source code licensed under additional open source
 * licenses. See the Open Source Licenses file (LICENSES.md) included with
 * this source code distribution or the Licensing information page available
 * at runtime from the About dialog for additional information.
 *****************************************************************************/
@mixin cols($totalCols, $span) {
    $cw: 100% / $totalCols;
    min-width: (500px / $totalCols) * $span;
    @if ($totalCols != $span) {
        width: ($cw * $span) - $ueColMargin;
    } @else {
        width: $cw;
    }
}

.holder-all {
    $myM: 0; // $interiorMarginSm;
    top: $myM;
    right: $myM;
    bottom: $myM;
    left: $myM;
}

.browse-area,
.edit-area,
.editor {
    position: absolute;
}

.editor {
    @include border-radius($basicCr * 1.5);
}

.contents {
    $myM: 0; //$interiorMargin;
    box-sizing: border-box;
    position: absolute;
    top: $myM;
    right: $myM;
    bottom: $myM;
    left: $myM;
    &.nomargin {
        $myM: 0px;
        right: $myM;
        bottom: $myM;
        left: $myM;
    }
}

.bar {
    .icon.major {
        margin-right: $interiorMargin;
    }
    &.abs {
        text-wrap: none;
        white-space: nowrap;
        &.left,
        .left {
            width: 45%;
            right: auto;
        }
        &.right,
        .right {
            width: 45%;
            left: auto;
            text-align: right;
            .icon.major {
                margin-left: $interiorMargin * 3;
            }
        }
        .l-flex,
        &.l-flex {
            .left,
            .right {
                width: auto;
            }
        }
    }
}

.user-environ {
    .browse-area,
    .edit-area,
    .editor {
        top: $bodyMargin + $ueTopBarH + ($interiorMargin);
        right: $bodyMargin;
        bottom: $ueFooterH + $bodyMargin;
        left: $bodyMargin;
    }

    .browse-area,
    .edit-area {
        > .contents {
            left: 0;
            right: 0;
        }
    }

    .edit-area {
        $tbH: $btnToolbarH + $interiorMargin;
        top: $bodyMargin + $ueTopBarEditH + ($interiorMargin);
        .tool-bar {
            border-bottom: 1px solid $colorInteriorBorder;
            bottom: auto;
            height: $tbH;
            line-height: $btnToolbarH;
        }
        .work-area {
            top: $tbH + $interiorMargin * 2;
        }
    }

    .ue-bottom-bar {
        //@include absPosDefault($bodyMargin);
        @include absPosDefault(0); // New status bar design
        top: auto;
        height: $ueFooterH;
        .status-holder {
            //right: $ueAppLogoW + $bodyMargin; New status bar design
            z-index: 1;
        }
        .app-logo {
            left: auto;
            width: $ueAppLogoW;
            z-index: 2;
        }
    }
}

.cols {
    @include clearfix;
    .col {
        @include box-sizing(border-box);
        @include clearfix;
        //		background: rgba(#ffcc00, 0.2);
        float: left;
        margin-left: $ueColMargin;
        padding-left: $interiorMargin;
        position: relative;
        &:first-child {
            margin-left: 0;
            padding-left: 0;
        }
    }
    &.cols-2 {
        $nc: 2;
        .col-1 {
            @include cols($nc, 1);
        }
    }
    &.cols-2-ff {
        // 2 columns, first column is fixed, second is fluid
        .col-100px {
            width: 100px;
        }
    }

    &.cols-6 {
        $nc: 6;
        .col-1 {
            @include cols($nc, 1);
        }
    }
    &.cols-16 {
        $nc: 16;
        .col-1 {
            @include cols($nc, 1);
        }
        .col-2 {
            @include cols($nc, 2);
        }
        .col-7 {
            @include cols($nc, 7);
        }
    }
    &.cols-32 {
        $nc: 32;
        .col-2 {
            @include cols($nc, 2);
        }
        .col-15 {
            @include cols($nc, 15);
        }
    }
    .l-row {
        @include clearfix;
        padding: $interiorMargin 0;
    }
}

.browse-mode {
    .split-layout {
        .split-pane-component.pane.left {
            min-width: 150px;
            max-width: 800px;
            width: $ueBrowseLeftPaneW;
        }
    }
}

.edit-mode {
    .split-layout {
        .split-pane-component.pane.right {
            width: 15%;
            .pane.bottom {
                min-height: 50px;
                height: 30%;
            }
        }
    }
}

.pane {
    position: absolute;
    &.treeview.left {
        .create-btn-holder {
            bottom: auto;
            top: 0;
            height: $ueTopBarH;
            .wrapper.menu-element {
                position: absolute;
                bottom: $interiorMargin;
            }
        }
        .search-holder {
            top: $ueTopBarH + $interiorMarginLg;
        }
        .tree-holder {
            overflow: auto;
            top: $ueTopBarH + $interiorMarginLg + $treeSearchInputBarH + $interiorMargin;
        }
    }
    &.items {
        .object-browse-bar {
            .left.abs,
            .right.abs {
                top: auto;
            }
        }
    }
}

.split-layout {
    &.horizontal {
        // Slides up and down
        > .pane {
            //			@include test();
            margin-top: $interiorMargin;
            &:first-child {
                margin-top: 0;
            }
        }
    }
    &.vertical {
        // Slides left and right
        > .pane {
            //            @include test();
            margin-left: $interiorMargin;
            > .holder {
                left: 0;
                right: 0;
            }
            &:first-child {
                margin-left: 0;
                .holder {
                    right: $interiorMarginSm;
                }
            }
        }

    }
}

.object-holder {
    @include trans-prop-nice-resize(0.25s);
    overflow: hidden; // Contained objects need to handle their own overflow now
    > ng-include {
        @include absPosDefault(0, auto);
    }
    &.l-controls-visible {
        &.l-time-controller-visible {
            bottom: nth($ueTimeControlH,1) + nth($ueTimeControlH,2) +nth($ueTimeControlH,3) + ($interiorMargin * 3);
        }
    }
}

.l-object-wrapper {
    @extend .abs;
    top: $ueTopBarH + $interiorMarginLg;
    &.active {
        @include pulseBorder($colorKey, 150ms, 8);
        @include border-radius($controlCr);
        border-color: $colorKey;
        border-width:2px;
        border-style: dotted;
        .l-object-wrapper-inner {
            $m: 3px;
            top: $m; right: $m; bottom: $m; left: $m;
        }
    }
}
.l-object-wrapper-inner {
    @extend .abs;
    @include display-flex(column nowrap);
    @include trans-prop-nice-resize(0.25s);
}

.l-edit-controls {
    @include trans-prop-nice-resize(0.25s);
    height: 0;
    opacity: 0;
    overflow: hidden;
    &.active {
        border-bottom: 1px solid $colorInteriorBorder;
        height: $ueEditToolBarH + $interiorMargin;
        line-height: $ueEditToolBarH;
        opacity: 1;
    }
}

.object-browse-bar .s-btn,
.top-bar .buttons-main .s-btn,
.top-bar .s-menu-btn,
.tool-bar .s-btn,
.tool-bar .s-menu-btn {
    $h: $btnToolbarH;
    height: $h;
    line-height: $h;
    vertical-align: top;
}

.object-browse-bar,
.top-bar {
    .view-switcher {
        margin-right: $interiorMarginLg * 2;
    }
}

.object-browse-bar {
    //@include test(blue);
    @include absPosDefault(0, visible);
    @include box-sizing(border-box);
    height: $ueTopBarH;
    line-height: $ueTopBarH;
    white-space: nowrap;

    .left {
        padding-right: $interiorMarginLg * 2;
        .l-back {
            display: inline-block;
            float: left;
            margin-right: $interiorMarginLg;
        }
    }
}

.l-flex {
    @include display-flex;
    &.flex-row {
        @include flex-flow(row nowrap);
        .flex-elem.active {
            margin-right: $interiorMargin;
            &:last-child {
                margin-right: 0;
            }
        }
    }
    &.flex-col {
        @include flex-flow(column nowrap);
        .flex-elem.active {
            margin-bottom: $interiorMarginLg;
            &:last-child {
                margin-bottom: 0;
            }
        }
    }
    .flex-elem {
        //@include test(purple);
        @include flex(0 1);
        position: relative;
        &.grow {
            @include flex(1 1);
        }
    }
    .left {
        @include flex(1 1 0);
        padding-right: $interiorMarginLg;
    }
}